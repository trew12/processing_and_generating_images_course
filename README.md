# Homework 2
Имеются изображения технологического процесса разлива металлических циллиндров. Есть риск нарушения технологии, когда стенки цилиндра не успевают застывать и трескаются. Не застывшый металл выливается, не образуя требуюмую заготовку. Необходимо оперативно определить лунку где произошел пролив. При этом пролив дольно редкое явление. Гораздо больше изображений можно собрать без пролива в лунке.

Задача: построить модель (на основе автоэнкодера) определяющую состояние лунки пролив\не пролив

## Архитектура
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/7f12b5b8-c8c6-42d0-85dd-ef411716a7d9)

## Результаты
Не пролив
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/d02d7740-943e-467c-8617-8e612f7fc68c)

Пролив
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/76845351-30b6-456c-9279-ed864874f6a2)

Тест
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/3b54a18d-d156-4e1d-972a-c6a190b10900)

Гистограмма распределения MSE на проливах / не проливах
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/af2a19e5-dfc4-4f71-993e-dfed73576dc1)

Гистограмма распределения MSE на тестовых данных
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/a558f978-8a7f-4ba6-a9b0-0224f11d9ed7)

Найденный порог с помощью Дерева решений глубины 1
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/8713018f-f2cd-4dd5-914a-b1d4f31bae87)

## Гиперпараметры
* Число эпох: 5
* Размерность латентного пространства: 32
* Размер батча: 64
* optimizer: AdamW
* lr: 0.001
* betas:  (0.9, 0.999)
* weight_decay: 0.01

## MSE
![image](https://github.com/trew12/processing_and_generating_images_course/assets/64497667/ba794cdc-ff33-4c2c-873a-1d0593739962)

## Метрики:
* TPR = 0.930
* FPR = 0.937

## Некоторые выводы
* Усложнение/упрощение архитектуры модели, подбор гиперпараметров (батча, LR, числа эпох), аугментации (повороты, флипы, изменения цвета) не дали существенного прироста качества
* Центрирование лунки обеспечило хороший прирост качества
* Использование размытия позволило избавиться от шума, что оказало наибольшее влияние на качество предсказаний (без этого не удавалось добится TPR и FPR больше 88)
* Распределения проливов/не проливов оказались почти линейно разделимыми
* Использование дерева решений для поиска порога позволило достигнуть необходимых значений метрик, однако, ручное тестирование подбора параметров показало, что результат может быть улучшен
